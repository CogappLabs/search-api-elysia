# yaml-language-server: $schema=./schemas/config.schema.json
# Search API Configuration
# Copy to config.yaml and fill in your values.
# Environment variables can be referenced with ${VAR_NAME} syntax.
# Use ${VAR_NAME:-default} to provide a fallback when the variable is not set.

port: ${PORT:-3000}

# Optional bearer token for API authentication.
# Can also be set via API_KEY env var.
# apiKey: ${API_KEY}

# Optional Redis cache. Set REDIS_URL env var to enable response caching.
# Search results are cached for 60s, mapping responses for 1h.
# Example: REDIS_URL=redis://default:password@redis.railway.internal:6379

# Optional CORS allowed origins (omit to disable CORS).
# corsOrigins: "*"            # Allow all origins
# corsOrigins:                # Or allow specific origins
#   - https://example.com
#   - https://app.example.com

indexes:
  # Each key becomes the URL handle (e.g. /collections/search)
  collections:
    engine: elasticsearch
    host: https://elasticsearch.example.com
    # Auth: use apiKey OR username/password (not both)
    apiKey: ${ES_API_KEY}
    # username: ${ES_USERNAME}
    # password: ${ES_PASSWORD}
    indexName: museum_collections
    defaults:
      perPage: 20
      facets:
        - category
        - period
      highlight: true
      # suggestField: title  # Required for phrase suggestions (ES 7+ removed _all)
    # fields:                # Unified field config: weight, searchable, field
    #   title:
    #     weight: 10         # Boost weight (implies searchable)
    #   description:
    #     weight: 2
    #   body:
    #     searchable: true   # Searchable without boost
    #   country:
    #     field: placeCountry  # Alias → real ES field name
    #   region:
    #     field: placeRegion
    #   coords:
    #     field: placeCoordinates
    #   facilityType:
    #     field: facilities.type
    #     nestedPath: facilities  # ES nested type — wraps filters/aggs automatically

  catalogue:
    engine: elasticsearch
    host: https://elasticsearch.example.com
    indexName: library_catalogue

  # Multi-index example: search across multiple ES indices with a single handle.
  # Results are unified and relevance-ranked; each hit includes an _index field.
  # all_content:
  #   engine: elasticsearch
  #   host: https://elasticsearch.example.com
  #   indexName:
  #     - museum_collections
  #     - library_catalogue

  # OpenSearch example: uses the same query DSL as Elasticsearch.
  # Auth: username/password only (no apiKey support in the OpenSearch JS client).
  # opensearch_index:
  #   engine: opensearch
  #   host: https://opensearch.example.com
  #   username: ${OS_USERNAME}
  #   password: ${OS_PASSWORD}
  #   indexName: my_opensearch_index

  # Meilisearch example: string-based filters, facetDistribution for facets.
  # No histogram, geoGrid, or suggest support.
  # meili_index:
  #   engine: meilisearch
  #   host: http://localhost:7700
  #   apiKey: ${MEILI_API_KEY}
  #   indexName: my_meili_index
  #   defaults:
  #     perPage: 20
  #     facets:
  #       - category

  # Typesense example: auto-detects schema from collection fields.
  # Date fields stored as int64 (Unix timestamps) need dateFields for ISO string conversion.
  # typesense_index:
  #   engine: typesense
  #   host: http://localhost:8108
  #   apiKey: ${TYPESENSE_API_KEY}
  #   indexName: my_typesense_collection
  #   dateFields:
  #     - postDate
  #   defaults:
  #     perPage: 20
  #     facets:
  #       - category
